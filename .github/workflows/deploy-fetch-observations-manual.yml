name: Deploy Fetch Observations (Manual)

on:
  workflow_dispatch:
    inputs:
      checkout_ref:
        description: Git ref to deploy (tag, branch, or commit SHA)
        required: true
        default: main
        type: string

permissions:
  id-token: write
  contents: read

jobs:
  deploy-fetch:
    concurrency:
      group: deploy-prod-fetch-observations
      cancel-in-progress: false
    uses: ./.github/workflows/reusable-deploy-sam-observations.yml
    with:
      checkout_ref: ${{ inputs.checkout_ref }}
      package_workspace: "@weather/fetch-observations"
      package_directory: packages/fetch-observations
      artifact_bucket: tempest-artifacts-fetch-prod
      stack_name: tempest-weather-fetch-observations-prod
    secrets: inherit
